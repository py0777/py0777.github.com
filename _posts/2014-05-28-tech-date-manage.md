---
title: "증권사 날짜관리"
categories:
  - Tech
tags: 
  - 날짜관리
  - 영업일
  - 거래일
  - 개장일
  - 증권
  - 금융IT
toc: true
toc_sticky: true
toc_label: 목차
popular: true
---

증권사 차세대 프로젝트에선, 기존 원장이관된 ASIS 소스를 분석한 후, 여러 새로운 도구와 프레임웍 상에서 개발하게 됩니다.
개발 환경이 바뀌고, 디자인 패턴이 바뀌게 되니, 당연히 개발자들도 개발표준을 공유해가며 개발해 나가야 합니다.
만약 개발표준을 지키지 않고, 자신의 경험만 믿고 개발을 하게 되면 다른이들이 볼때 가독성이 떨어지며, 관리하기 어려운 소스가 되버립니다.

그렇게 지켜야하는 표준 및 규칙 중 하나가 날짜 입니다.

### 증권회사는 날짜 유형별로 거래일자, 개장일자, 영업일자 등의 날짜를 테이블로 관리합니다.

- 거래일자: 거래를 발생시킨 날짜
- 영업일자: 증권지점에서 업무를 하는 날짜
- 개장일자: 거래소가 운영되는 날짜

### 예를 들어, 2014년 12월 에서 2015년 1월사이의 달력입니다. 

| 일   | 월   | 화   | 수   | 목   | 금   |토|
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| 21   | 22   | 23   | 24   | 25   | 26   |27|
| 28   | 29 | 30 | 31 |      |      ||



오늘이 26일 이라면, 날짜는 아래와 같이 관리 됩니다.

|    | D-3  | D-2   | D-1   | D-DAY   | D-1   |D-2|D-3|
| :--: | :--: | :--: | :--: | :--: | :--: | :--: |:--:|
| 거래일   | 20141223   | 20141224   | 20141225   | 20141226   | 20141227  |20141228|20141229|
| 영업일   | 20141222|20141223 | 20141224   | 20141226| 20141229 |20141230|20141231|
| 개장일(한국거래소)  | 20141222 | 20141223 | 20141224 | 20141226|20141229|20141230|20150102|



 **1. 거래일은 달력의 날짜와 동일하게 관리 됩니다.**
\- 주말 과 휴일에 상관없이 관리 되게 때문에 D+1일은 토요일인 12월 27이고, D-1일은 성탄절인 12월 25일 입니다.

**2. 영업일은 주말과 공휴일은 제외하게 됩니다.**
\- 주 5일 근무를 하기때문에, 지점은 토요일에 근무를 하지 않습니다. 그래서 D+1일은 다음주 월요일인 12월29일이고, D-1일은 12월 24일 입니다.
과거 토요일 근무를 하던 시절엔 토요일도 영업일 이었겠지요.

**3. 개장일은 주말과 공휴일을 제외하고, 거래소 휴장일인 12월 31을 제외합니다.**
\- 개장일은 거래소가 운영되는 날로, 주식 주문 가능한 날짜입니다. 대부분을 일자는 영업일과 동일하게 적용되지만, 12월 31일은 영업일 이지만, 개장일이 아닙니다.

**Q :그렇다면 만약 오늘이 12월 27일 이라면 거래일, 영업일 개장일은 어떻게 설정 되고, 각각의 D-1, D+1은 어떻게 설정 될까요?**

A:
D   DAY :거래일 : 2014. 12.27, 영업일: 2014.12.26 개장일: 2014.12.26
D -1 DAY :거래일 : 2014. 12.26, 영업일: 2014.12.24 개장일: 2014.12.24
D +1DAY :거래일 : 2014. 12.28, 영업일: 2014.12.29 개장일: 2014.12.29

\- 위 날짜관리 테이블에서 영업일과 개장일은 변화 없이 거래일만 바뀌게 되는 거죠.

**Q: 오늘이 12월 30일 이라면 거래일, 영업일 개장일은 어떻게 설정 되고, 각각의 D-1, D+1은 어떻게 설정 될까요?**

A:
D   DAY :거래일 : 2014. 12.30, 영업일: 2014.12.30 개장일: 2014.12.30
D -1 DAY :거래일 : 2014. 12.29, 영업일: 2014.12.29개장일: 2014.12.29
D +1DAY :거래일 : 2014. 12.31, 영업일: 2014.12.31 개장일: 2015.01.02

이렇게 날짜를 유형별로 테이블로 관리하는 이유는, 일자별로 수행되야 하는 업무가 별도로 존재하기 때문입니다.

### 거래일

우리가 HTS나 WEB등에서 24시간 이용할 수 있기때문에, 거래를 발생시킨 날짜 입니다. 이렇게 실시간으로 매일매일 발생하는 일자에 사용하게 됩니다.

### 영업일

배치나, 영업일에만 수행되는 업무들에서 체크 역할을 합니다.
예를 들어 신용이자 정기징수는 매월 첫번째 영업일에 수행 됩니다. 매월 첫번째 영업일은 1일 일수도 있지만, 1일이 주말 또는 휴일일 수도 있기 때문에,
지점직원들이 출근하는 첫번째 영업일에 해당 배치를 수행하게 됩니다.

### 개장일

주식 주문이나, 수도결제시에 사용 되게 됩니다.
수도결제는 주식 주문이 체결된날짜로 부터 D+2일 새벽에 진행되게 됩니다. 수도결제가 진행 되면서 입출금고가 발생하는데 만약 거래소의 실수 또는 증권회사의 실수로 고객계좌에 예수금 또는 주식잔고가 틀려지게 되면, 거래소 담당자와 협업해 문제를 해결해야 하는데, 개장일이 아닌 날짜에 수도결제가 수행되면, 집에서 쉬고있는 거래소 직원들을 출근시켜 문제를 해결해야 겠지요.. ㅎㅎ

ASIS 프로그램을 보게 되면, SQL에서 SYSDATE를 사용해서 현재일을 가져오게 됩니다.
하지만, 24*365를 수행하는 시스템에서는 SYSDATE를 사용해서는 제약을 받게 되는 경우가 많아, 날짜 테이블의 일자를 공통영역에 담아두었다가 사용하게 됩니다. SYSDATE를 사용하게 되면, 하루는 24시간 입니다. 그래서 당일 거래일에 처리해야 하는 업무는 23시59분 59초 전에는 무조건 처리해야 합니다. 하지만, 일자 테이블의 거래일자를 사용하게 되면, 24시가 넘어 물리적인 날짜가 변경되어도, 마치 전일에 처리된 것처럼 관리할 수 있게 됩니다.
또한, 매월 특정일에 수행되야하는 프로그램을 개발해 두고, 테스트를 진행할 때도, 테스트 서버의 일자테이블만 변경하면, 마치 그 일자처럼 테스트를 진행할 수 있게 되는 장점이 있습니다.