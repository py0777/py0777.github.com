---
title: "출금처리설계"
categories:

  - Tech
tags: 
  - 출금처리설계
  - 증권
  - 금융IT
toc: true
toc_sticky: true
toc_label: 목차
popular: true
---

출금처리 프로세스는 각 증권사 마다 다르지만, 제가 프로그램 설계시엔 아래와 같은 방식으로 하고 있으니, 참고하셨으면 합니다.

### 1. 검증###
 1.1) 계좌검증
 1.2) 거래가능여부 검증
 1.3) 금액 검증

### 2. 처리###
 2.1) 채번
 2.2) 출금가능금액 계산
 2.3) 잔고반영
 - 미수반영
 - 잔고갱신
 2.4) 내역생성

### 3. 후처리###
 3.1) SMS 호출
 3.2) 회계 반영
 3.3) 전표 생성

위와 같이 설계하는 것이 현재 MVC 패턴 설계에도 더 잘 맞고 유지보수도 편리합니다.

한 예로, 많은 증권사들이 2000년대 초반 트리거 방식의 구현에서는 아래와 같은 방식으로 처리됩니다.

### 1. 검증###
 1.1) 계좌검증
 1.2) 거래가능여부 검증
 1.3) 금액검증

### 2. 처리###
2.1) 채번
2.2) 거래내역 생성 (TRIGGER 발생)
 - 잔고반영
 - 미수반영
 - SMS호출
 - 회계반영 등등.

이와 같이 트리거로 구현된 프로그램은 출금프로그램을 호출할 필요없이 트리거에서 if ~ else if ~ 분기문을 통해 모든 것을 처리하고 있기때문에, 호출하는 쪽에선 편할 수 있지만, 거래내역 trigger를 수정하는 사람은 손떨려서 어디 수정할 수 있겠습니까? 출금 수정하려했다가, 입금 안될수도 있으니 말이죠.